<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Predplatn√© Kalkulaƒçka</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        .animate-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        #loading { position: fixed; top:0; left:0; width:100%; height:100%; background: white; display: flex; justify-content: center; align-items: center; z-index: 1000; flex-direction: column; gap: 15px; }
        .spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>

    <script>
        window.onerror = function(message, source, lineno, colno, error) {
            const root = document.getElementById('root');
            const loading = document.getElementById('loading');
            if(loading) loading.style.display = 'none';
            if(root) {
                root.innerHTML = `
                    <div style="color: #7f1d1d; background: #fef2f2; border: 2px solid #b91c1c; padding: 20px; margin: 20px; border-radius: 8px; font-family: sans-serif;">
                        <h2 style="font-weight: bold; margin-bottom: 10px;">‚ö†Ô∏è Nastala chyba:</h2>
                        <p>${message}</p>
                        <p style="margin-top:10px; font-size: 0.9em">Sk√∫s vypn√∫≈• AdBlock, ak ho pou≈æ√≠va≈°.</p>
                    </div>
                `;
            }
        };
    </script>

    <script crossorigin src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    <script crossorigin src="https://cdn.jsdelivr.net/npm/recharts@2.12.0/umd/Recharts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.23.10/babel.min.js"></script>
</head>
<body class="bg-gray-50">

    <div id="loading">
        <div class="spinner"></div>
        <div class="text-gray-600 font-medium">Naƒç√≠tavam aplik√°ciu...</div>
    </div>

    <div id="root"></div>

    <script type="text/babel">
        // Kontrola naƒç√≠tania kni≈æn√≠c
        if (!window.React || !window.ReactDOM || !window.Recharts) {
            throw new Error("Nepodarilo sa stiahnu≈• potrebn√© kni≈ænice (React alebo Recharts). Skontroluj internet alebo vypni AdBlock.");
        }

        const { useState, useEffect } = React;
        const { createRoot } = ReactDOM;
        const { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Cell, LabelList } = Recharts;

        // --- ZAƒåIATOK TVOJHO K√ìDU ---

        const Card = ({ children, className = "" }) => {
          const defaultBg = className.includes('bg-') ? '' : 'bg-white';
          return (
            <div className={`rounded-xl shadow-md p-6 ${defaultBg} ${className}`}>
              {children}
            </div>
          );
        };

        const SERVICES_DB = [
          {
            id: 'youtube',
            name: 'YouTube & Music',
            icon: "üì∫", 
            color: '#ff0000',
            plans: [
              { id: 'none', name: '≈Ωiadne predplatn√©', monthly: 0, yearly: 0 },
              { id: 'yt_premium_ind', name: 'Premium (Jednotlivec)', monthly: 7.19, yearly: null },
              { id: 'yt_premium_fam', name: 'Premium (Rodina)', monthly: 10.99, yearly: null },
              { id: 'yt_premium_student', name: 'Premium (≈†tudent)', monthly: 4.19, yearly: null },
              { id: 'yt_music', name: 'Music Premium', monthly: 5.99, yearly: null },
            ]
          },
          {
            id: 'google_one',
            name: 'Google One (√ölo≈æisko & AI)',
            icon: "‚òÅÔ∏è",
            color: '#34a853',
            plans: [
              { id: 'none', name: '15 GB (Zadarmo)', monthly: 0, yearly: 0 },
              { id: 'basic_100', name: 'Basic 100 GB', monthly: 1.99, yearly: 19.99 },
              { id: 'standard_200', name: 'Standard 200 GB', monthly: 2.99, yearly: 29.99 },
              { id: 'premium_2tb', name: 'Premium 2 TB', monthly: 9.99, yearly: 99.99 },
              { id: 'ai_premium_2tb', name: 'AI Premium 2 TB (Gemini)', monthly: 21.99, yearly: null },
            ]
          },
          {
            id: 'play_pass',
            name: 'Google Play Pass',
            icon: "üéÆ",
            color: '#fbbc04',
            plans: [
              { id: 'none', name: 'Neakt√≠vne', monthly: 0, yearly: 0 },
              { id: 'play_pass_std', name: 'Play Pass', monthly: 4.99, yearly: 29.99 },
            ]
          }
        ];

        const App = () => {
          const [selections, setSelections] = useState(() => {
            const initial = {};
            SERVICES_DB.forEach(service => {
              initial[service.id] = { planId: 'none', billing: 'monthly' };
            });
            initial['youtube'] = { planId: 'yt_premium_fam', billing: 'monthly' };
            initial['google_one'] = { planId: 'premium_2tb', billing: 'monthly' };
            initial['play_pass'] = { planId: 'play_pass_std', billing: 'monthly' };
            return initial;
          });

          const [aiAnalysis, setAiAnalysis] = useState('');
          const [isAnalyzing, setIsAnalyzing] = useState(false);

          const updateSelection = (serviceId, field, value) => {
            setSelections(prev => ({
              ...prev,
              [serviceId]: { ...prev[serviceId], [field]: value }
            }));
          };

          const calculateTotals = () => {
            let monthlyTotal = 0;
            let yearlyTotal = 0;
            let optimizedYearlyTotal = 0;
            let breakdown = [];

            SERVICES_DB.forEach(service => {
              const sel = selections[service.id];
              const plan = service.plans.find(p => p.id === sel.planId);
              
              if (plan && plan.id !== 'none') {
                let cost = 0;
                let yearlyCostOpt = 0;

                if (sel.billing === 'yearly' && plan.yearly) {
                  cost = plan.yearly / 12;
                  yearlyTotal += plan.yearly;
                } else {
                  cost = plan.monthly;
                  yearlyTotal += plan.monthly * 12;
                }

                if (plan.yearly) {
                  yearlyCostOpt = plan.yearly;
                } else {
                  yearlyCostOpt = plan.monthly * 12;
                }
                optimizedYearlyTotal += yearlyCostOpt;

                monthlyTotal += cost;
                
                breakdown.push({
                  id: service.id,
                  name: service.name,
                  value: cost,
                  color: service.color,
                  billing: sel.billing,
                  canOptimize: sel.billing === 'monthly' && plan.yearly !== null
                });
              }
            });

            return { monthlyTotal, yearlyTotal, optimizedYearlyTotal, breakdown };
          };

          const stats = calculateTotals();
          const yearlySavingsPotential = stats.yearlyTotal - stats.optimizedYearlyTotal;

          const getShortName = (id) => {
            switch(id) {
              case 'youtube': return 'YouTube';
              case 'google_one': return 'Google One';
              case 'play_pass': return 'Play Pass';
              default: return 'Slu≈æba';
            }
          };

          const chartData = [
            ...stats.breakdown.map(item => ({
              name: getShortName(item.id),
              cena: parseFloat(item.value.toFixed(2)),
              fill: item.color
            })),
            {
              name: 'SPOLU',
              cena: parseFloat(stats.monthlyTotal.toFixed(2)),
              fill: '#1f2937'
            }
          ];

          const analyzeWithGemini = async () => {
            setIsAnalyzing(true);
            setAiAnalysis('');
            setTimeout(() => {
                setAiAnalysis("üí° Tip: M√°te skvel√Ω v√Ωber slu≈æieb! Ak prejdete na roƒçn√∫ platbu pri Google One a Play Pass, u≈°etr√≠te takmer 20 % roƒçne. YouTube Premium Rodina je najv√Ωhodnej≈°ia voƒæba pre viac ƒçlenov.");
                setIsAnalyzing(false);
            }, 1500);
          };

          // Skryjeme loader po naƒç√≠tan√≠ komponentu
          useEffect(() => { 
             const loader = document.getElementById('loading');
             if(loader) loader.style.display = 'none';
          }, []);

          useEffect(() => { setAiAnalysis(''); }, [selections]);

          return (
            <div className="p-4 max-w-5xl mx-auto bg-gray-50 min-h-screen font-sans">
              <div className="mb-8 text-center">
                <h1 className="text-3xl font-bold text-gray-800 mb-2">Google Predplatn√©: Konfigur√°tor</h1>
                <p className="text-gray-600">Analyzuj ƒæubovoƒæn√∫ kombin√°ciu slu≈æieb a n√°jdi optim√°lne nastavenie</p>
              </div>

              <div className="grid lg:grid-cols-3 gap-6 mb-6">
                
                <div className="lg:col-span-2 space-y-4">
                  <Card className="border-t-4 border-blue-500">
                    <h2 className="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                      <span>‚ö°</span> V√Ωber slu≈æieb
                    </h2>
                    
                    <div className="space-y-6">
                      {SERVICES_DB.map((service) => {
                        const currentSelection = selections[service.id];
                        const currentPlan = service.plans.find(p => p.id === currentSelection.planId);
                        const isSelected = currentSelection.planId !== 'none';
                        
                        return (
                          <div key={service.id} className={`p-4 rounded-xl border transition-all ${isSelected ? 'bg-white border-blue-200 shadow-sm' : 'bg-gray-50 border-gray-100 opacity-80 hover:opacity-100'}`}>
                            <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
                              
                              <div className="flex items-center gap-3 min-w-[200px]">
                                <div className={`p-2 rounded-lg text-white text-xl`} style={{ backgroundColor: service.color }}>
                                  {service.icon}
                                </div>
                                <span className="font-semibold text-gray-700">{service.name}</span>
                              </div>

                              <div className="flex flex-wrap items-center gap-3 flex-1 justify-end">
                                <select 
                                  className="bg-white border border-gray-300 text-gray-700 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 min-w-[180px]"
                                  value={currentSelection.planId}
                                  onChange={(e) => updateSelection(service.id, 'planId', e.target.value)}
                                >
                                  {service.plans.map(plan => (
                                    <option key={plan.id} value={plan.id}>
                                      {plan.name} {plan.id !== 'none' ? `(‚Ç¨${plan.monthly}/mes)` : ''}
                                    </option>
                                  ))}
                                </select>

                                {isSelected && currentPlan.yearly !== null && (
                                  <div className="flex items-center bg-gray-100 rounded-lg p-1">
                                    <button
                                      onClick={() => updateSelection(service.id, 'billing', 'monthly')}
                                      className={`px-3 py-1.5 text-xs font-medium rounded-md transition-all ${currentSelection.billing === 'monthly' ? 'bg-white shadow text-gray-800' : 'text-gray-500'}`}
                                    >
                                      Mesaƒçne
                                    </button>
                                    <button
                                      onClick={() => updateSelection(service.id, 'billing', 'yearly')}
                                      className={`px-3 py-1.5 text-xs font-medium rounded-md transition-all ${currentSelection.billing === 'yearly' ? 'bg-green-100 text-green-700' : 'text-gray-500'}`}
                                    >
                                      Roƒçne (-17%)
                                    </button>
                                  </div>
                                )}
                                 {isSelected && currentPlan.yearly === null && (
                                    <span className="text-xs text-gray-400 px-2">Len mesaƒçne</span>
                                 )}
                              </div>
                            </div>
                          </div>
                        );
                      })}
                    </div>
                  </Card>

                  <Card className="bg-gradient-to-r from-purple-50 to-indigo-50 border border-purple-100">
                     <div className="flex justify-between items-center mb-3">
                        <div className="flex items-center gap-2 text-purple-800 font-bold">
                            <span>‚ú®</span> AI Optimaliz√°tor
                        </div>
                        <button 
                            onClick={analyzeWithGemini}
                            disabled={isAnalyzing}
                            className="text-xs bg-purple-600 text-white px-3 py-2 rounded-lg hover:bg-purple-700 disabled:opacity-50 transition-colors"
                        >
                            {isAnalyzing ? 'Analyzujem...' : 'Analyzova≈• zlo≈æenie'}
                        </button>
                     </div>
                     {aiAnalysis && (
                        <div className="bg-white/80 p-3 rounded-lg text-sm text-gray-800 italic animate-in">
                            {aiAnalysis}
                        </div>
                     )}
                  </Card>
                </div>

                <div className="space-y-4">
                  
                  <Card className="bg-gray-900 text-white border-none relative overflow-hidden">
                    <div className="relative z-10">
                        <p className="text-gray-400 text-xs uppercase tracking-wider font-semibold">Mesaƒçn√Ω priemer</p>
                        <h3 className="text-5xl font-bold my-2">‚Ç¨{stats.monthlyTotal.toFixed(2)}</h3>
                        <div className="flex justify-between items-end border-t border-gray-700 pt-3 mt-3">
                            <div>
                                <p className="text-gray-400 text-xs">Roƒçn√© n√°klady</p>
                                <p className="font-semibold">‚Ç¨{stats.yearlyTotal.toFixed(2)}</p>
                            </div>
                            {yearlySavingsPotential > 1 && (
                                 <div className="text-right">
                                    <p className="text-green-400 text-xs">Mo≈æn√° √∫spora</p>
                                    <p className="font-bold text-green-400">‚Ç¨{yearlySavingsPotential.toFixed(2)} /rok</p>
                                 </div>
                            )}
                        </div>
                    </div>
                    <div className="absolute right-0 top-0 opacity-10 transform translate-x-10 -translate-y-10 text-9xl">
                        üßÆ
                    </div>
                  </Card>

                  {stats.breakdown.some(i => i.canOptimize) && (
                      <Card className="border-l-4 border-green-500 bg-green-50">
                        <h4 className="font-bold text-green-800 text-sm mb-2 flex items-center gap-2">
                            <span>üê∑</span> Tip na √∫sporu
                        </h4>
                        <ul className="text-xs text-green-700 space-y-1">
                            {stats.breakdown.filter(i => i.canOptimize).map(item => (
                                <li key={item.name}>
                                    ‚Ä¢ Prepnite <b>{item.name}</b> na roƒçn√∫ platbu.
                                </li>
                            ))}
                        </ul>
                      </Card>
                  )}
                </div>
              </div>

               {stats.breakdown.length > 0 && (
                    <Card className="w-full">
                      <h3 className="font-bold text-gray-700 mb-4 text-lg">Porovnanie mesaƒçn√Ωch n√°kladov</h3>
                      <div className="h-64 w-full">
                        <ResponsiveContainer width="100%" height="100%">
                          <BarChart data={chartData} layout="vertical" margin={{ top: 5, right: 60, left: 20, bottom: 5 }}>
                            <CartesianGrid strokeDasharray="3 3" horizontal={false} />
                            <XAxis type="number" unit="‚Ç¨" domain={[0, 'auto']} />
                            <YAxis dataKey="name" type="category" width={100} tick={{fontSize: 12, fontWeight: 500}} />
                            <Tooltip 
                                formatter={(value) => [`‚Ç¨${value}`, 'Cena']}
                                contentStyle={{ borderRadius: '8px', border: 'none', boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)' }}
                            />
                            <Bar dataKey="cena" radius={[0, 4, 4, 0]} barSize={40}>
                              {chartData.map((entry, index) => (
                                <Cell key={`cell-${index}`} fill={entry.fill} />
                              ))}
                              <LabelList 
                                dataKey="cena" 
                                position="right" 
                                formatter={(val) => `‚Ç¨${val}`} 
                                style={{ fontSize: '13px', fill: '#666', fontWeight: 600 }} 
                              />
                            </Bar>
                          </BarChart>
                        </ResponsiveContainer>
                      </div>
                    </Card>
                 )}
            </div>
          );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>